SELECT
    DATE_TRUNC('day', BLOCK_TIMESTAMP) AS day,
    
    sum(CASE WHEN TOKEN_IN = LOWER('0xba100000625a3754423978a60c9317c58a424e3d') THEN amount_in ELSE 0 END + 
        CASE WHEN TOKEN_OUT = LOWER('0xba100000625a3754423978a60c9317c58a424e3d') THEN amount_out ELSE 0 END) AS BALANCER_TOKEN_VOLUME,
    
    sum(CASE WHEN TOKEN_IN = LOWER('0xba100000625a3754423978a60c9317c58a424e3d') THEN amount_in_usd ELSE 0 END + 
        CASE WHEN TOKEN_OUT = LOWER('0xba100000625a3754423978a60c9317c58a424e3d') THEN amount_out_usd ELSE 0 END) AS BALANCER_TOKEN_USD_VOLUME,


FROM ethereum.defi.ez_dex_swaps
GROUP BY day
HAVING BALANCER_TOKEN_VOLUME > 0
ORDER BY day;
