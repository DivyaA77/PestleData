SELECT
    DATE_TRUNC('day', BLOCK_TIMESTAMP) AS day,
    
    sum(CASE WHEN TOKEN_IN = LOWER('0x5a98fcbea516cf06857215779fd812ca3bef1b32') THEN amount_in ELSE 0 END + 
        CASE WHEN TOKEN_OUT = LOWER('0x5a98fcbea516cf06857215779fd812ca3bef1b32') THEN amount_out ELSE 0 END) AS LIDO_TOKEN_VOLUME,
    
    sum(CASE WHEN TOKEN_IN = LOWER('0x5a98fcbea516cf06857215779fd812ca3bef1b32') THEN amount_in_usd ELSE 0 END + 
        CASE WHEN TOKEN_OUT = LOWER('0x5a98fcbea516cf06857215779fd812ca3bef1b32') THEN amount_out_usd ELSE 0 END) AS LIDO_TOKEN_USD_VOLUME,

 sum(CASE WHEN TOKEN_IN = LOWER('0xae7ab96520de3a18e5e111b5eaab095312d7fe84') THEN amount_in ELSE 0 END + 
        CASE WHEN TOKEN_OUT = LOWER('0xae7ab96520de3a18e5e111b5eaab095312d7fe84') THEN amount_out ELSE 0 END) AS STETH_TOKEN_VOLUME,
    
    sum(CASE WHEN TOKEN_IN = LOWER('0xae7ab96520de3a18e5e111b5eaab095312d7fe84') THEN amount_in_usd ELSE 0 END + 
        CASE WHEN TOKEN_OUT = LOWER('0xae7ab96520de3a18e5e111b5eaab095312d7fe84') THEN amount_out_usd ELSE 0 END) AS STETH_TOKEN_USD_VOLUME
        
FROM ethereum.defi.ez_dex_swaps
GROUP BY day
HAVING LIDO_TOKEN_VOLUME > 0 and STETH_TOKEN_VOLUME > 0
ORDER BY day;
