SELECT
    DATE_TRUNC('day', BLOCK_TIMESTAMP) AS day,
    
    sum(CASE WHEN TOKEN_IN = LOWER('0xd533a949740bb3306d119cc777fa900ba034cd52') THEN amount_in ELSE 0 END + 
        CASE WHEN TOKEN_OUT = LOWER('0xd533a949740bb3306d119cc777fa900ba034cd52') THEN amount_out ELSE 0 END) AS COMPOUND_TOKEN_VOLUME,
    
    sum(CASE WHEN TOKEN_IN = LOWER('0xd533a949740bb3306d119cc777fa900ba034cd52') THEN amount_in_usd ELSE 0 END + 
        CASE WHEN TOKEN_OUT = LOWER('0xd533a949740bb3306d119cc777fa900ba034cd52') THEN amount_out_usd ELSE 0 END) AS COMPOUND_TOKEN_USD_VOLUME,


FROM ethereum.defi.ez_dex_swaps
GROUP BY day
HAVING COMPOUND_TOKEN_VOLUME > 0
ORDER BY day;
